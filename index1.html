<!doctype html>
<html>
  <head>
    <title>Invaders United</title>
    <script type="text/javascript" src="assets/js/cake.js"></script>
    <script type="text/javascript">
window.onload = function() 
{

	var CAKECanvas = new Canvas(document.body, 1024, 768);
	
	var scaleFactor = 7;
	
	var invJSON = {"sprite1": [
        {"x": 0, "y": 0, "w": 2, "h": 1},
        {"x": 3, "y": 0, "w": 5, "h": 1},
		{"x": 9, "y": 0, "w": 3, "h": 1},		
        {"x": 0, "y": 1, "w": 3, "h": 1},
        {"x": 4, "y": 1, "w": 3, "h": 1},
        {"x": 8, "y": 1, "w": 4, "h": 1},		
        {"x": 0, "y": 2, "w": 2, "h": 1},
        {"x": 9, "y": 2, "w": 3, "h": 1},        
		{"x": 0, "y": 3, "w": 1, "h": 1},
        {"x": 3, "y": 3, "w": 1, "h": 1},
        {"x": 7, "y": 3, "w": 1, "h": 1},
        {"x": 10, "y": 3, "w": 2, "h": 1},
		{"x": 11, "y": 4, "w": 1, "h": 1},		
        {"x": 1, "y": 5, "w": 1, "h": 1},
		{"x": 9, "y": 5, "w": 1, "h": 1},
		{"x": 11, "y": 5, "w": 1, "h": 1},			
		{"x": 1, "y": 6, "w": 1, "h": 1},
		{"x": 3, "y": 6, "w": 5, "h": 1},		
		{"x": 9, "y": 6, "w": 1, "h": 1},	
		{"x": 11, "y": 6, "w": 1, "h": 1},
		{"x": 0, "y": 7, "w": 3, "h": 1},
		{"x": 5, "y": 7, "w": 1, "h": 1},	
		{"x": 8, "y": 7, "w": 4, "h": 1}, 	      
        ], 
		"sprite2": [
        {"x": 0, "y": 0, "w": 2, "h": 1},
        {"x": 3, "y": 0, "w": 5, "h": 1},
		{"x": 9, "y": 0, "w": 3, "h": 1},		
        {"x": 0, "y": 1, "w": 3, "h": 1},
        {"x": 4, "y": 1, "w": 3, "h": 1},
        {"x": 8, "y": 1, "w": 4, "h": 1},		
        {"x": 0, "y": 2, "w": 2, "h": 1},
        {"x": 9, "y": 2, "w": 3, "h": 1},        
		{"x": 0, "y": 3, "w": 1, "h": 1},
        {"x": 3, "y": 3, "w": 1, "h": 1},
        {"x": 7, "y": 3, "w": 1, "h": 1},
        {"x": 10, "y": 3, "w": 2, "h": 1},
		{"x": 11, "y": 4, "w": 1, "h": 1},		
        {"x": 1, "y": 5, "w": 1, "h": 1},
		{"x": 9, "y": 5, "w": 1, "h": 1},
		{"x": 11, "y": 5, "w": 1, "h": 1},			
		{"x": 1, "y": 6, "w": 1, "h": 1},
		{"x": 3, "y": 6, "w": 5, "h": 1},		
		{"x": 9, "y": 6, "w": 1, "h": 1},	
		{"x": 11, "y": 6, "w": 1, "h": 1},
		{"x": 0, "y": 7, "w": 3, "h": 1},
		{"x": 5, "y": 7, "w": 1, "h": 1},	
		{"x": 8, "y": 7, "w": 4, "h": 1},	    
        ] 
    };
	
	var sprite = [scaleFactor*0,scaleFactor*0,scaleFactor*12,scaleFactor*8];
	var sprite1Array = new Array();
	sprite1Array.push(['fillRect', sprite]);
	for( var i in invJSON.sprite1  ) {
		var o = invJSON.sprite1[i];
		var coords = [scaleFactor*o.x, scaleFactor*o.y, scaleFactor*o.w, scaleFactor*o.h];
		if( i < 28){
			sprite1Array.push(['clearRect', coords]);
		}
    }

	var sprite2Array = new Array();
	sprite2Array.push(['fillRect', sprite]);
	for( var i in invJSON.sprite2  ) {
		var o = invJSON.sprite2[i];
		var coords = [scaleFactor*o.x, scaleFactor*o.y, scaleFactor*o.w, scaleFactor*o.h];
		if( i < 29){
			sprite2Array.push(['clearRect', coords]);
		}
    }
	var invader = new Path(sprite1Array,{
			fill: '#ff0000',
			fillOpacity:1
		});
		
	var current = "sprite1";
	invader.every(1000, 
		function() 
		{
			if( current == "sprite1") { 
				this.compiled = sprite2Array;
				current = "sprite2";
			} else {
				this.compiled = sprite1Array;
				current = "sprite1";
			}
		},
		true
	);
	
	/*
	invader.addFrameListener(
		function(t, dt) 
		{
			this.scale = Math.sin(t / 1000);
		}
	);
	*/
	
	CAKECanvas.append(invader);

	var start = new ElementNode(E('h2', 'START'), 
		{
			fontFamily: 'Arial, Sans-serif', 
			noScaling: true, 
			color: 'black',
			x: CAKECanvas.width / 2, 
			y: CAKECanvas.height / 2,
			align: 'center',
			valign: 'center'
		}
	);
	
					
	CAKECanvas.append(start);
};
	</script>
    <style type="text/css">
      * { margin: 0; padding: 0; }
      html, body { width: 100%; height: 100%; overflow: hidden;}
      canvas { border: 0 solid black; overflow: hidden; width: 100%; height: 100%; margin: 0 auto;}
    </style>
  </head>
  <body>

  </body>
</html>
